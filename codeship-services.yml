api:
  build:
    image: 457201446358.dkr.ecr.eu-central-1.amazonaws.com/hqtrust-core-api
    dockerfile_path: Dockerfile
  depends_on:
    - db
  cached: true
deploy_prod:
  build:
    dockerfile_path: Dockerfile-deploy
  encrypted_env_file: deployment-k8s-prod.env.encrypted
  environment:
    - KUBECONFIG=/config/.kube/config
    - NAMESPACE=hqtrust-core-api
    - CLUSTER_USER=codeship
deploy_dev:
  build:
    dockerfile_path: Dockerfile-deploy
  encrypted_env_file: deployment-k8s-dev.env.encrypted
  environment:
    - KUBECONFIG=/config/.kube/config
    - NAMESPACE=hqtrust-core-api
    - CLUSTER_USER=codeship
db:
  image: healthcheck/postgres:alpine
  environment:
    POSTGRES_USER: hqtrust_core_api
    POSTGRES_DB: 86RRfQkPw93NYDyX
dockercfg_generator:
  image: codeship/aws-ecr-dockercfg-generator
  add_docker: true
  encrypted_env_file: deployment-ecr.env.encrypted
  environment:
    - AWS_REGION=eu-central-1
